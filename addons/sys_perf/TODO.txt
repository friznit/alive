TODO
- Tidy up init and logic
- Sort out FSM that never ends
